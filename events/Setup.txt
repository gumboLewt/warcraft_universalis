namespace = setup

country_event = {
  id = setup.1
  title = setup.1.title
  desc = setup.1.desc
  picture = ASSASSINATION_eventPicture

  hidden = yes
  is_triggered_only = yes

  trigger = {
    NOT = { has_global_flag = completed_setup }
  }

  immediate = {
    set_global_flag = completed_setup
  }

  option = {
    name = setup.1.option.a

    set_global_flag = enable_hero_system

    # Configure HRE
    hre_inheritable = yes

    # Game flags
    # Used to detect which bookmark the flag starts in, accounting for time adjustments
    set_global_flag = dark_portal_built

    # The Rise of the Qiraji
    if = {
      limit = {
        NOT = { is_year = 941 }
      }
      set_global_flag = rise_of_the_qiraji
    }

    # The Burning Crusade
    if = {
      limit = {
        is_year = 941
        NOT = { is_year = 946 }
      }
      set_global_flag = the_burning_crusade
    }

    # Wrath of the Lich King
    if = {
      limit = {
        is_year = 946
        NOT = { is_year = 971 }
      }
      set_global_flag = wrath_of_the_lich_king
    }

    # Cataclysm
    if = {
      limit = {
        is_year = 971
        NOT = { is_year = 976 }
      }
      set_global_flag = cataclysm
    }

    # Mists of Pandaria
    if = {
      limit = {
        is_year = 976
        NOT = { is_year = 987 }
      }
      set_global_flag = mists_of_pandaria
    }

    # Legion
    if = {
      limit = {
        is_year = 987
      }
    }
    set_global_flag = legion
  }
}

country_event = {
  id = setup.2
  title = setup.1.title
  desc = setup.1.desc
  picture = ASSASSINATION_eventPicture

  hidden = yes
  is_triggered_only = yes

  trigger = {
    NOT = { has_country_flag = completed_country_setup }
  }

  immediate = {
    set_country_flag = completed_country_setup
  }

  option = {
    name = setup.1.option.a

    # Heroes
    if = {
      limit = {
        has_global_flag = enable_hero_system
      }

      set_variable = {
        which = hero_count
        value = 0
      }

      set_variable = {
        which = raids_cleared
        value = 0
      }
    }

    if = {
      limit = {
        has_country_modifier = alliance_member
      }

      opinions_joined_alliance = yes
    }

    if = {
      limit = {
        has_country_modifier = horde_member
      }
      opinions_joined_horde = yes
    }
  }
}
